
; ---- TSB d
    ORG $0400
    FETCHADDRESS_d TMP2 TMP3    
    LOAD TMP2 TMP3 V0 TMP5
    BRACCU16 TSB_d_16bit
    TEST8 TMP5 ALO
    OR8 TMP5 ALO
    STORE TMP2 TMP3 V0 TMP5
    NEXT
TSB_d_16bit:
    CPINC16 TMP7 TMP8 TMP2 TMP3
    LOAD TMP7 TMP8 V0 TMP6
    TEST16 TMP5 TMP6 ALO AHI
    OR8 TMP5 ALO
    OR8 TMP6 AHI
    STORE TMP2 TMP3 V0 TMP5
    STORE TMP7 TMP8 V0 TMP6
    NEXT

; ---- TSB a
    ORG $0C00
    FETCHADDRESS_a TMP2 TMP3 TMP4    
    LOAD TMP2 TMP3 TMP4 TMP5
    BRACCU16 TSB_a_16bit
    TEST8 TMP5 ALO
    OR8 TMP5 ALO
    STORE TMP2 TMP3 TMP4 TMP5
    NEXT
TSB_a_16bit:
    CPINC24 TMP7 TMP8 TMP9 TMP2 TMP3 TMP4
    LOAD TMP7 TMP8 TMP9 TMP6
    TEST16 TMP5 TMP6 ALO AHI
    OR8 TMP5 ALO
    OR8 TMP6 AHI
    STORE TMP2 TMP3 TMP4 TMP5
    STORE TMP7 TMP8 TMP9 TMP6
    NEXT

